model DocumentType {
  id              String   @id @default(uuid()) @db.Uuid
  name            String
  code            String   @unique
  description     String?
  validationRules Json?
  isRequired      Boolean  @default(false)
  expiresInDays   Int?
  isActive        Boolean  @default(true)
  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt

  userDocuments UserDocument[]
}

model UserDocument {
  id             String         @id @default(uuid()) @db.Uuid
  userId         String         @db.Uuid
  documentTypeId String         @db.Uuid
  status         DocumentStatus @default(PENDING)
  fileUrl        String?
  storagePath    String?
  expiryDate     DateTime?      @db.Date
  rejectedReason String?
  reviewedAt     DateTime?
  reviewedBy     String?        @db.Uuid
  createdAt      DateTime       @default(now())
  updatedAt      DateTime       @updatedAt

  user          User           @relation(fields: [userId], references: [id], onDelete: Cascade)
  documentType  DocumentType   @relation(fields: [documentTypeId], references: [id], onDelete: Cascade)
  verifications VerificationLog[]

  @@index([userId])
  @@index([documentTypeId])
}

model VerificationLog {
  id             String   @id @default(uuid()) @db.Uuid
  userDocumentId String   @db.Uuid
  action         String
  performedBy    String   @db.Uuid
  notes          String?
  createdAt      DateTime @default(now())

  userDocument UserDocument @relation(fields: [userDocumentId], references: [id], onDelete: Cascade)

  @@index([userDocumentId])
}
